---
title: "Flutterが楽しい"
date: 2020-04-05T16:40:38+09:00
draft: true
categories: ["Flutter"]
---

## Flutter

https://flutter.dev/

2018年12月に正式リリースされた、Googleが開発するオープンソースのモバイルアプリ向けフレームワーク（iOS, Androidへクロスコンパイル可）。
flutterで開発する際は Dart（https://dart.dev/）という言語で開発する。

web版は現時点ではベータ版。正式版はリリースされてない。

web版が正式にリリースされれば、iOS・Android・Webフロントエンドの全てが一度に開発できるようになる非常に協力なフレームワーク。

## 今回の内容

flutterを触ってみて特徴的に感じた点などについて感想を書いていく

- 1.アプリ開発なのに敷居が低く感じた
- 2.dart
- 3.ウィジェットの更新

## 1.アプリ開発なのに敷居が低く感じた

### doctorコマンド

これは Flutterを触って直感的にすぐわかりました。

開発環境構築がとても簡単で、何ができて何ができていないのか `flutter doctor` コマンドですぐにわかる。

### widget

画面に配置するUIの部品。

flutterには、マテリアルデザインの widgetがプリセットのような形で予め定義されているので、それらを組み合わせるだけでアプリが簡単に完成する。

超大雑把に言うと、見た目の部品はできてるのであとは挙動をコーディングしたらアプリ完成。すごい。

それをベースに自分のアプリで使いたいようにカスタマイズしても良いし、自分でウィジェットをイチから作っても良い。

### cupertino widget

iOSの見た目をしたウィジェット。

最初マテリアルデザインで開発してて、iOSライクな見た目じゃなくて気持ち悪いなあと思っていたのですが、このようにiOSライクな見た目のウィジェットも使えます。（https://flutter.dev/docs/development/ui/widgets/cupertino）

※Appleの本社がある場所がカルフォルニア州クパチーノにあるからそこから命名？

## 2.dart

Flutterで開発する際に使う **dart** は静的型付けに開発できます。（一応動的型付けとして開発する事も可能らしい）

### NNBD

また、現在null安全ではない言語ですが **non-null by default(NNBD)** として解決する方針のようです。（詳しく知りたい方はNNBDで検索）
null安全な言語になればnull考慮漏れが引き起こすバグも減るはずなのでこの辺りは期待しています。

### Functional?

Scalaを関数型で開発してる型にとっては少し物足りないかもしれませんが、最低限の便利なメソッド等は実装されている印象でした。
ジェネリクスがサポートされてるので、`List<String>` や `List<Int>` のような型もサポートされています。
また、`List` には `map, expand(flatMap) reduce, fold, forEach, where(filter)` のような高階関数も標準で存在しています。

`traverse, forAll` の実装や、 `Either, Option` あたりの型があったら嬉しかった。（traverse は、Listに限って言えば、unitまたはpure同等のモノが実装されてるようなものなので、自分で作ろうと思えば作れるとは思うのですが…）

もっと厳密に関数型として開発したい場合は、関数型のパッケージも開発されてるようなのでそちらを使ってみるのも良いかもしれません。(https://github.com/spebbe/dartz)

## 3.ウィジェットの更新

SPAのフロントをがっつり開発した経験が無い自分にとってはここが結構難しかった。
詳しいメリット・デメリット等についてはそれぞれのやり方で調べてみて欲しい。あくまで所感ベースで書きます。

### setState

#### setStateの挙動

Flutterを始めて最初に取得するウィジェットの更新方法が恐らく **setState** だと思う。

例えばボタンのウィジェットでボタンが押された際に何か変更を加える場合

```main.dart
onPressed: () {
  setState(() => _count++);
}
// _countはStateのメンバ変数
```

このように書く必要がある。
`onPressed` の定義をクロージャで行い、その中で **setState** を呼ぶが、与える引数もクロージャ。

#### 僕はsetStateは嫌い

僕はFlutterを書いていて **setStateは嫌い** だと思った。

ロジックをメソッドで切り出す事はできるけど、綺麗に切り出す自信が無かったし、値の変更結果は結局メンバ変数に格納しなければならない。

そのため、いくらメソッドを綺麗に切り分けたとしても限界があると感じた。

例えば setState の中身が100行あった場合、とてもわかりにくくなってしまう。

```main.dart
onPressed: () {
  setState(() => {
    // 1...
    // 2...
    // ...
    // 99...
    // 100...
    _count++;
  });
}
// _countはStateのメンバ変数
```

